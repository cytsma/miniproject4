---
title: "Mini Project 4"
author: "Cai Ytsma, Juliane Bombosch, Sofia Salcedo"
date: "April 27, 2018"
output: html_document
---
COMPARING APRIL 2005 and APRIL 2015


Using taxi and plane data, joining databases? To see connections between taxi and plane, in the shadow of ride sharing services.


```{r}
#calling the libraries
library(tidyverse)
library(mdsr)
library(RMySQL)
nyctaxi <- dbConnect_scidb(dbname = "nyctaxi")
airlines <- dbConnect_scidb(dbname = "airlines")
```

Sofia goals: gathering Uber and lyft info
1. create a database that has the dates of the information from Uber and lyft info
What am I trying to get out of that? 
- how many trips were made per day for each

- there's nothing in the tables that has lyft or uber data, the rows just say "null"

```{r}
uber_april_2015 <- read.csv("./uber-raw-data-april153.csv")
head(uber_april_2015)

```

for finding the location of the airport, try using PULocationID in the "yellow" taxi data

----------
Cai goals: estimate number of people leaving the airport by date

delineate by domestic/intl - find number cabs per capita and assume differences due to uber

```{r, label = "find most average flight month"}
popular_months <- airlines %>%
  dbGetQuery("SELECT month, SUM(1) AS sum
FROM airlines.flights
WHERE dest = 'JFK'
GROUP BY month
ORDER BY sum DESC;")


deviation <- popular_months %>%
  summarize(mean = sum(sum)/12)

mean <- deviation[[1]]

most_avg_month <- popular_months %>%
  mutate(near_avg = abs((sum/mean) - 1)) %>%
  arrange(near_avg) %>%
  head(1)
```

```{r, label = "get flight info"}
flights <- airlines %>%
  dbGetQuery("SELECT f.*, p.seats FROM airlines.flights f
INNER JOIN airlines.planes p
	ON p.tailnum = f.tailnum
WHERE f.year IN (2005, 2015)
AND f.month = 4
AND f.dest = 'JFK';")
```

```{r, label = "max number of people leaving per day"}
people_per_day <- flights %>% 
  group_by(year, month, day) %>%
  summarize(num_people = sum(seats)) 
```



